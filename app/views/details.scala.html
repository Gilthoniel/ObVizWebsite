
@(webpage: WebPage, app: AndroidApp, related: java.util.List[AndroidApp])

@main(webpage) {

    @* Information about the application *@
    <div class="row" id="app-description">
        <div class="col-md-6">
            <h1><img height="40" src="@app.getImage" alt="" /> @app.getName</h1>

            @views.html.templates.app_description(app, webpage)
        </div>

        <div class="col-md-6">
            <div class="slick-screenshots">
                @for(screenshot <- app.getScreenshots.take(10)) {
                    <div><img data-lazy="@screenshot" src="" alt="" /></div>
                }
            </div>
        </div>
    </div>

    @if(related.size() > 0) {
        <h2>
            Alternatives
            @if(app.isParsed) {
                <small>Click to compare</small>
            }
        </h2>
        <div id="alternatives">
            <div class="slick-alternatives">
                @for(alternative <- related) {
                    <div>
                        <div class="alternative-body" data-id="@alternative.getAppID"
                                @if(!app.isParsed) {data-url="@routes.Application.details(alternative.getAppID)"}>

                            <div class="header" style="background-image: url('@alternative.getRandomScreen(400)')">
                                <div class="sub-header">
                                    <table>
                                        <tr>
                                            <td class="logo"><img src="@alternative.getImage" alt="" /></td>
                                            <td>@alternative.getName</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    }

    @if(app.isParsed) {
        <h2 id="anchor-comparison">Opinions of the crowd</h2>
        <div class="row" id="details-aspects">
            @* Global gauge *@
            <div class=" col-xs-12 col-md-4">
                <div id="global-gauge" data-title="Global" data-value="@app.getGlobalOpinion" class="chart-gauge"></div>
            </div>

            @* List of all the topics *@
            <div class="col-xs-12 col-md-8 list-aspects">
            @for(opinionValue <- app.getMostImportantTopics.take(8)) {

                <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
                    <div class="opinion-box" data-topic="@opinionValue.getTopicID">
                        <div id="gauge-@opinionValue.getTopicID" data-title="@webpage.getTopics.getTitle(opinionValue.getTopicID)"
                        data-value="@opinionValue.percentage()" class="chart-gauge"></div>
                    </div>
                </div>
            }
            </div>
        </div>

        <div class="row" id="details-reviews" data-url="@routes.AJAX.getReviews()">

            @* List of the reviews of the application *@
            <div class="col-xs-12">
                <div id="base-container">
                    @views.html.templates.pager()

                    <div class="loading-message">
                    @views.html.templates.loading()
                    </div>

                    @for(opinion <- app.getOpinions) {
                        <div class="topic-container" data-topic="@opinion.getTopicID" style="display: none;">

                    </div>
                    }

                    @views.html.templates.pager()
                </div>

                <div id="comparison-container" style="display: none;">

                    @* Comparison tabs *@
                    <ul class="nav nav-tabs" role="tablist">
                        <li role="tab" class="active">
                            <a href="#tab-description" data-toggle="tab">Description</a>
                        </li>
                        <li role="tab">
                            <a href="#tab-screenshots" data-toggle="tab">Screenshots</a>
                        </li>
                        <li role="tab">
                            <a href="#tab-reviews" id="tab-link-reviews" data-toggle="tab">Reviews</a>
                        </li>

                        <li class="pull-right">
                            <button type="button" class="btn btn-danger" onclick="OBVIZ.comparison.stop();">
                                <span class="glyphicon glyphicon-remove"></span> Stop the comparison
                            </button>
                        </li>
                    </ul>

                    <div class="col-xs-6">
                        <h1 class="title-app">
                            <img height="40" src="@app.getImage" alt="" /> @app.getName
                        </h1>
                    </div>
                    <div class="col-xs-6">
                    @for(application <- related) {
                        <div class="app-title" data-id="@application.getAppID" style="display: none;">
                            <h1 class="title-comparison">
                                <a href="@routes.Application.details(application.getAppID)">
                                    <img height="40" src="@application.getImage" alt="" /> @application.getName
                                    <small><span class="glyphicon glyphicon-share-alt"></span></small>
                                </a>
                            </h1>
                        </div>
                    }
                    </div>
                    <div class="clearfix"></div>

                    @* Comparison panes *@
                    <div class="tab-content">
                        @* Description *@
                        <div role="tabpanel" class="tab-pane active" id="tab-description">
                            <div class="col-xs-6">
                            @views.html.templates.app_description(app, webpage)
                            </div>
                            <div class="col-xs-6">
                            @for(application <- related) {
                                <div class="app-description" data-id="@application.getAppID" style="display: none;">
                                @views.html.templates.app_description(application, webpage)
                                </div>
                            }
                            </div>
                        </div>
                        @* Screenshots *@
                        <div role="tabpanel" class="tab-pane" id="tab-screenshots">
                            <div class="col-xs-6">
                                <ul>
                                @for(screenshot <- app.getScreenshots) {
                                    <li><img src="@screenshot" alt="" /></li>
                                }
                                </ul>
                            </div>

                            <div class="col-xs-6">
                            @for(application <- related) {
                                <div class="app-screenshot" data-id="@application.getAppID" style="display: none;">
                                    <ul>
                                    @for(screenshot <- application.getScreenshots) {
                                        <li><img src="@screenshot" alt="" /></li>
                                    }
                                    </ul>
                                </div>
                            }
                            </div>
                        </div>
                        @* Reviews *@
                        <div role="tabpanel" class="tab-pane" id="tab-reviews">
                            @views.html.templates.pager()

                            <div class="col-xs-6 current">
                                <div class="loading-message">
                                @views.html.templates.loading()
                                </div>

                                @for(opinion <- app.getOpinions) {
                                    <div class="topic-container" data-topic="@opinion.getTopicID" style="display: none;"></div>
                                }
                            </div>
                            <div class="col-xs-6 compared">
                                <div class="loading-message">
                                @views.html.templates.loading()
                                </div>

                                @for(opinion <- app.getOpinions) {
                                    <div class="topic-container" data-topic="@opinion.getTopicID" style="display: none;"></div>
                                }
                            </div>

                            @views.html.templates.pager()
                        </div>
                    </div>
                </div>
            </div>
        </div>
    } else {
        <div id="app-not-parsed">
            I'm currently working on this to get the information. Please come back later !
        </div>
    }

    <div id="data" style="display:none;">
        <div data-id="@app.getAppID" data-main="true">
            <div data-topic="0" data-value="@app.getGlobalOpinion"></div>
            @for(value <- app.getOpinions) {
                <div data-topic="@value.getTopicID" data-value="@value.percentage()"></div>
            }
        </div>

        @for(application <- related) {
            <div data-id="@application.getAppID">
                <div data-topic="0" data-value="@application.getGlobalOpinion"></div>
                @for(value <- application.getOpinions) {
                    <div data-topic="@value.getTopicID" data-value="@value.percentage()"></div>
                }
            </div>
        }
    </div>

    <script type="text/javascript" src="@routes.Assets.versioned("javascripts/pages/details.js")"></script>
    <script type="text/javascript" src="@routes.Assets.versioned("amcharts/amcharts.js")"></script>
    <script type="text/javascript" src="@routes.Assets.versioned("amcharts/gauge.js")"></script>
    <script type="text/javascript" src="@routes.Assets.versioned("amcharts/themes/light.js")"></script>
}
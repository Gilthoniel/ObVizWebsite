@(app: PlayApp, titles: Map[Integer, List[String]], related: List[PlayApp])

@import models.OpinionValue

@main() {
    <div class="row" id="details-header">
        <div class="col-xs-12 col-md-6">
            <table class="logo">
                <tr>
                    <td>
                        <img src="@app.getImage" alt="Logo" />
                    </td>
                    <td>
                        @app.getName
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <div id="details-gauge">
        <div class="opinion-slider">
            @for((id, opinionValue) <- app.getMappedOpinions) {
                <div>
                    <div class="opinion-box" data-topic="@id">
                        <canvas width="220" height="100" data-value="@opinionValue.percentage" class="gauge"></canvas>
                        <h4>@titles.get(id).head</h4>
                    </div>
                </div>
            }
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12 col-md-2" id="details-related">
            <h3>Related Apps</h3>
            <ul>
                @for(app <- related) {
                    <li>
                        <a href="@routes.Application.details(app.getAppID)">
                            <img src="@app.getImage" alt="@app.getName" />
                        </a>
                    </li>
                }
            </ul>
        </div>
        <div class="col-xs-12 col-md-10" id="details-reviews">
        @for((id, reviews) <- app.getMappedReviews) {
            <div id="topic-@id" class="topic-container" style="display: none;">
            @for(review <- reviews) {
                <div class="review">
                    @Html(review.getParsedBody(id))
                </div>
            }
            </div>
        }
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function() {
            var containers = $(".topic-container");
            var opinionBoxes = $(".opinion-box");

            $(".opinion-slider").on('init', function() {
                console.log("fireddd");
                opinionBoxes.click(function() {

                    // Add active class
                    opinionBoxes.removeClass("active");
                    $(this).addClass("active");

                    // Show the reviews of the opinion
                    var id = $(this).data("topic");

                    containers.hide();
                    $("#topic-"+id).fadeIn(500);
                });
            }).slick({
                mobileFirst: true,
                slidesToShow: 1,
                infinite: false,
                swipeToSlide: true,
                dots: true,
                respondTo: 'slider',
                responsive: [
                    {
                        breakpoint: 1200,
                        settings: {
                            slidesToShow: 6
                        }
                    },
                    {
                        breakpoint: 1000,
                        settings: {
                            slidesToShow: 5
                        }
                    },
                    {
                        breakpoint: 800,
                        settings: {
                            slidesToShow: 4
                        }
                    },
                    {
                        breakpoint: 600,
                        settings: {
                            slidesToShow: 3
                        }
                    },
                    {
                        breakpoint: 400,
                        settings: {
                            slidesToShow: 2
                        }
                    },
                    {
                        breakpoint: 250,
                        settings: {
                            slidesToShow: 1
                        }
                    }
                ]
            });

            var opts = {
                lines: 12,
                angle: 0,
                lineWidth: 0.15,
                pointer: {
                    length: 0.4,
                    strokeWidth: 0.05,
                    color: '#000000'
                },
                limitMax: 'false',
                percentColors: [[0.0, "#cf1414" ], [0.5, "#aeaeae"], [1.0, "#1c8e17"]],
                strokeColor: '#e0e0e0',
                generateGradient: true
            };

            $(".gauge").each(function() {
                var gauge = new Gauge($(this).get(0)).setOptions(opts);
                gauge.maxValue = 100;
                gauge.animationSpeed = 300;
                gauge.set(parseInt($(this).data("value")));
            });
        })
    </script>
}